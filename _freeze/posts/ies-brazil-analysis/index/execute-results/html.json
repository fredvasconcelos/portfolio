{
  "hash": "b999cf7bc44f9b010a8a311051f9389d",
  "result": {
    "markdown": "---\ntitle: \"IES Analysis Brazil\"\nauthor: \"Fred Vasconcelos\"\ndate: \"2023-07-31\"\ncategories: [education, analysis, r, ggplot2]\nimage: \"image.jpg\"\n---\n\n\n# IES Analysis Brazil\n\n\n\n\n\n# ETL\n\n## Load libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rstatix)\nlibrary(ggplot2)\nlibrary(factoextra)\nlibrary(ggrepel)\nlibrary(cluster)\nlibrary(ggthemes)\n```\n:::\n\n\n## Load data\n\nWe create a list of data frames for faster de creation of the data.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlisted_df <- file_paths %>%\n  map(function (path) {\n    read.csv(path, sep = ';', encoding = 'latin1')\n  }) %>%\n  tibble() \n```\n:::\n\n\n## Feature enginering\n\nThe data frames don't have information about Regions and States of Brazil because. We get this information with the *IES CODE* in the **IES DATABASE**.\n\n\n::: {.cell}\n\n:::\n\n\n## View data frame structure\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlisted_df %>%\n  unnest(cols = '.') %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 201\n  NU_ANO_CENSO NO_REGIAO CO_REGIAO NO_UF   SG_UF CO_UF NO_MUNICIPIO CO_MUNICIPIO\n         <int> <chr>         <int> <chr>   <chr> <int> <chr>               <int>\n1         2009 Norte             1 Rondôn… RO       11 Ariquemes         1100023\n2         2009 Norte             1 Rondôn… RO       11 Ariquemes         1100023\n3         2009 Norte             1 Rondôn… RO       11 Ariquemes         1100023\n4         2009 Norte             1 Rondôn… RO       11 Ariquemes         1100023\n5         2009 Norte             1 Rondôn… RO       11 Ariquemes         1100023\n6         2009 Norte             1 Rondôn… RO       11 Ariquemes         1100023\n# ℹ 193 more variables: IN_CAPITAL <int>, TP_DIMENSAO <int>,\n#   TP_ORGANIZACAO_ACADEMICA <int>, TP_CATEGORIA_ADMINISTRATIVA <int>,\n#   TP_REDE <int>, CO_IES <int>, NO_CURSO <chr>, CO_CURSO <int>,\n#   NO_CINE_ROTULO <chr>, CO_CINE_ROTULO <chr>, CO_CINE_AREA_GERAL <int>,\n#   NO_CINE_AREA_GERAL <chr>, CO_CINE_AREA_ESPECIFICA <int>,\n#   NO_CINE_AREA_ESPECIFICA <chr>, CO_CINE_AREA_DETALHADA <int>,\n#   NO_CINE_AREA_DETALHADA <chr>, TP_GRAU_ACADEMICO <int>, IN_GRATUITO <int>, …\n```\n:::\n:::\n\n\n## Describe variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlisted_df %>%\n  unnest(cols = '.') %>%\n  skimr::skim()\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |           |\n|:------------------------|:----------|\n|Name                     |Piped data |\n|Number of rows           |1886955    |\n|Number of columns        |201        |\n|_______________________  |           |\n|Column type frequency:   |           |\n|character                |11         |\n|numeric                  |190        |\n|________________________ |           |\n|Group variables          |None       |\n\n\n**Variable type: character**\n\n|skim_variable           | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-----------------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|NO_REGIAO               |         0|          1.00|   0|  12| 34256|        6|          0|\n|NO_UF                   |         0|          1.00|   0|  19| 34256|       28|          0|\n|SG_UF                   |         0|          1.00|   0|   2| 34256|       28|          0|\n|NO_MUNICIPIO            |         0|          1.00|   0|  29| 34256|     3198|          0|\n|NO_CURSO                |         0|          1.00|   3| 200|     0|     9370|          0|\n|NO_CINE_ROTULO          |         0|          1.00|   4|  98|     0|      366|          0|\n|CO_CINE_ROTULO          |    344691|          0.82|   9|   9|     0|      366|          0|\n|NO_CINE_AREA_GERAL      |         0|          1.00|   8|  58|     0|       11|          0|\n|NO_CINE_AREA_ESPECIFICA |         0|          1.00|   5|  98|     0|       37|          0|\n|NO_CINE_AREA_DETALHADA  |         0|          1.00|   5|  98|     0|       89|          0|\n|CO_CINE_ROTULO2         |   1542264|          0.18|   9|   9|     0|      350|          0|\n\n\n**Variable type: numeric**\n\n|skim_variable                | n_missing| complete_rate|       mean|        sd|      p0|     p25|     p50|     p75|     p100|hist  |\n|:----------------------------|---------:|-------------:|----------:|---------:|-------:|-------:|-------:|-------:|--------:|:-----|\n|NU_ANO_CENSO                 |         0|          1.00|    2017.69|      3.44|    2009|    2016|    2019|    2020|     2021|▁▁▂▂▇ |\n|CO_REGIAO                    |     34256|          0.98|       3.06|      1.05|       1|       2|       3|       4|        5|▂▃▇▅▂ |\n|CO_UF                        |     34256|          0.98|      34.03|      9.55|      11|      29|      35|      41|       53|▂▂▇▃▂ |\n|CO_MUNICIPIO                 |     34256|          0.98| 3419623.40| 955648.59| 1100015| 2927408| 3509502| 4119905|  5300108|▂▂▇▃▂ |\n|IN_CAPITAL                   |     34256|          0.98|       0.17|      0.38|       0|       0|       0|       0|        1|▇▁▁▁▂ |\n|TP_DIMENSAO                  |         0|          1.00|       1.79|      0.45|       1|       2|       2|       2|        4|▂▇▁▁▁ |\n|TP_ORGANIZACAO_ACADEMICA     |         0|          1.00|       1.60|      0.73|       1|       1|       1|       2|        5|▇▅▂▁▁ |\n|TP_CATEGORIA_ADMINISTRATIVA  |         0|          1.00|       4.04|      1.03|       1|       4|       4|       4|        9|▁▇▂▁▁ |\n|TP_REDE                      |     64865|          0.97|       1.90|      0.30|       1|       2|       2|       2|        2|▁▁▁▁▇ |\n|CO_IES                       |         0|          1.00|    1362.33|   2451.04|       1|     322|     671|    1491|    25613|▇▁▁▁▁ |\n|CO_CURSO                     |         0|          1.00|  896052.29| 709979.97|       1|  100630| 1190156| 1382707| 50017018|▇▁▁▁▁ |\n|CO_CINE_AREA_GERAL           |         0|          1.00|       4.24|      2.77|       0|       1|       4|       6|       10|▆▇▂▂▃ |\n|CO_CINE_AREA_ESPECIFICA      |         0|          1.00|      43.59|     27.85|       1|      11|      41|      61|      108|▆▇▂▂▃ |\n|CO_CINE_AREA_DETALHADA       |         0|          1.00|     439.15|    278.37|      11|     115|     413|     615|     1088|▆▇▂▂▃ |\n|TP_GRAU_ACADEMICO            |      4349|          1.00|       2.07|      0.86|       1|       1|       2|       3|        4|▇▅▁▇▁ |\n|IN_GRATUITO                  |     52146|          0.97|       0.09|      0.28|       0|       0|       0|       0|        1|▇▁▁▁▁ |\n|TP_MODALIDADE_ENSINO         |         0|          1.00|       1.78|      0.42|       1|       2|       2|       2|        2|▂▁▁▁▇ |\n|TP_NIVEL_ACADEMICO           |         0|          1.00|       1.00|      0.03|       1|       1|       1|       1|        2|▇▁▁▁▁ |\n|QT_CURSO                     |    726856|          0.61|       0.39|      0.49|       0|       0|       0|       1|        1|▇▁▁▁▅ |\n|QT_VG_TOTAL                  |    726856|          0.61|     116.34|   1257.30|       0|       0|       0|      76|   149108|▇▁▁▁▁ |\n|QT_VG_TOTAL_DIURNO           |    746430|          0.60|      20.19|     75.10|       0|       0|       0|       0|    20134|▇▁▁▁▁ |\n|QT_VG_TOTAL_NOTURNO          |    746430|          0.60|      36.45|    101.28|       0|       0|       0|      35|    20142|▇▁▁▁▁ |\n|QT_VG_TOTAL_EAD              |    726856|          0.61|      60.66|   1250.52|       0|       0|       0|       0|   149108|▇▁▁▁▁ |\n|QT_VG_NOVA                   |    726856|          0.61|      69.96|   1069.28|       0|       0|       0|       0|    74600|▇▁▁▁▁ |\n|QT_VG_PROC_SELETIVO          |    726856|          0.61|       0.00|      0.00|       0|       0|       0|       0|        0|▁▁▇▁▁ |\n|QT_VG_REMANESC               |    726856|          0.61|      24.90|    362.78|       0|       0|       0|       0|    74587|▇▁▁▁▁ |\n|QT_VG_PROG_ESPECIAL          |    726856|          0.61|       0.31|     42.04|       0|       0|       0|       0|    29840|▇▁▁▁▁ |\n|QT_INSCRITO_TOTAL            |    726856|          0.61|     164.07|   1357.11|       0|       0|       0|      70|   398817|▇▁▁▁▁ |\n|QT_INSCRITO_TOTAL_DIURNO     |    746430|          0.60|      67.33|    456.00|       0|       0|       0|       0|   112694|▇▁▁▁▁ |\n|QT_INSCRITO_TOTAL_NOTURNO    |    746430|          0.60|      58.62|    266.04|       0|       0|       0|       0|    59935|▇▁▁▁▁ |\n|QT_INSCRITO_TOTAL_EAD        |    726856|          0.61|      34.27|   1227.58|       0|       0|       0|       0|   398817|▇▁▁▁▁ |\n|QT_INSC_VG_NOVA              |    726856|          0.61|     111.68|   1256.57|       0|       0|       0|       0|   398254|▇▁▁▁▁ |\n|QT_INSC_PROC_SELETIVO        |    726856|          0.61|       0.00|      0.00|       0|       0|       0|       0|        0|▁▁▇▁▁ |\n|QT_INSC_VG_REMANESC          |    726856|          0.61|       8.82|    217.44|       0|       0|       0|       0|   126798|▇▁▁▁▁ |\n|QT_INSC_VG_PROG_ESPECIAL     |    726856|          0.61|       0.29|     15.20|       0|       0|       0|       0|     5028|▇▁▁▁▁ |\n|QT_ING                       |     19574|          0.99|      20.98|     59.29|       0|       1|       3|      17|    12082|▇▁▁▁▁ |\n|QT_ING_FEM                   |     19574|          0.99|      11.81|     38.69|       0|       0|       1|       8|    11116|▇▁▁▁▁ |\n|QT_ING_MASC                  |     19574|          0.99|       9.17|     27.34|       0|       0|       1|       6|     3333|▇▁▁▁▁ |\n|QT_ING_DIURNO                |     19574|          0.99|       4.84|     24.08|       0|       0|       0|       0|     1821|▇▁▁▁▁ |\n|QT_ING_NOTURNO               |     19574|          0.99|       8.25|     32.73|       0|       0|       0|       0|     5041|▇▁▁▁▁ |\n|QT_ING_VG_NOVA               |     19574|          0.99|      12.73|     41.13|       0|       0|       1|       7|     5041|▇▁▁▁▁ |\n|QT_ING_VESTIBULAR            |     19574|          0.99|      14.70|     44.22|       0|       0|       2|       9|     5037|▇▁▁▁▁ |\n|QT_ING_ENEM                  |     19574|          0.99|       3.84|     18.56|       0|       0|       0|       1|     1714|▇▁▁▁▁ |\n|QT_ING_AVALIACAO_SERIADA     |     19574|          0.99|       0.06|      1.39|       0|       0|       0|       0|      301|▇▁▁▁▁ |\n|QT_ING_SELECAO_SIMPLIFICA    |     19574|          0.99|       0.98|     10.85|       0|       0|       0|       0|     2292|▇▁▁▁▁ |\n|QT_ING_EGR                   |     19574|          0.99|       0.01|      0.74|       0|       0|       0|       0|      202|▇▁▁▁▁ |\n|QT_ING_OUTRO_TIPO_SELECAO    |     19574|          0.99|       0.00|      0.00|       0|       0|       0|       0|        0|▁▁▇▁▁ |\n|QT_ING_PROC_SELETIVO         |     19574|          0.99|       0.00|      0.00|       0|       0|       0|       0|        0|▁▁▇▁▁ |\n|QT_ING_VG_REMANESC           |     19574|          0.99|       1.67|     11.91|       0|       0|       0|       0|     2366|▇▁▁▁▁ |\n|QT_ING_VG_PROG_ESPECIAL      |     19574|          0.99|       0.05|      1.86|       0|       0|       0|       0|      601|▇▁▁▁▁ |\n|QT_ING_OUTRA_FORMA           |     19574|          0.99|       0.75|     14.12|       0|       0|       0|       0|    12023|▇▁▁▁▁ |\n|QT_ING_0_17                  |     19574|          0.99|       0.18|      1.11|       0|       0|       0|       0|      167|▇▁▁▁▁ |\n|QT_ING_18_24                 |     19574|          0.99|      10.90|     33.36|       0|       0|       1|       5|     2579|▇▁▁▁▁ |\n|QT_ING_25_29                 |     19574|          0.99|       3.57|     11.06|       0|       0|       1|       3|     1865|▇▁▁▁▁ |\n|QT_ING_30_34                 |     19574|          0.99|       2.50|      8.34|       0|       0|       0|       2|     2411|▇▁▁▁▁ |\n|QT_ING_35_39                 |     19574|          0.99|       1.72|      6.28|       0|       0|       0|       1|     2281|▇▁▁▁▁ |\n|QT_ING_40_49                 |     19574|          0.99|       1.62|      6.78|       0|       0|       0|       1|     3101|▇▁▁▁▁ |\n|QT_ING_50_59                 |     19574|          0.99|       0.43|      2.13|       0|       0|       0|       0|      993|▇▁▁▁▁ |\n|QT_ING_60_MAIS               |     19574|          0.99|       0.06|      0.41|       0|       0|       0|       0|      131|▇▁▁▁▁ |\n|QT_ING_BRANCA                |     19574|          0.99|       6.76|     22.95|       0|       0|       1|       4|     2537|▇▁▁▁▁ |\n|QT_ING_PRETA                 |     19574|          0.99|       1.06|      4.63|       0|       0|       0|       1|      638|▇▁▁▁▁ |\n|QT_ING_PARDA                 |     19574|          0.99|       4.44|     18.31|       0|       0|       0|       2|     2121|▇▁▁▁▁ |\n|QT_ING_AMARELA               |     19574|          0.99|       0.26|      1.66|       0|       0|       0|       0|      358|▇▁▁▁▁ |\n|QT_ING_INDIGENA              |     19574|          0.99|       0.08|      1.21|       0|       0|       0|       0|      313|▇▁▁▁▁ |\n|QT_ING_CORND                 |     19574|          0.99|       8.39|     36.16|       0|       0|       0|       3|    11944|▇▁▁▁▁ |\n|QT_MAT                       |     19574|          0.99|      53.81|    159.59|       0|       1|       4|      35|    16351|▇▁▁▁▁ |\n|QT_MAT_FEM                   |     19574|          0.99|      30.85|    100.77|       0|       0|       2|      17|    14801|▇▁▁▁▁ |\n|QT_MAT_MASC                  |     19574|          0.99|      22.96|     74.28|       0|       0|       2|      12|     5946|▇▁▁▁▁ |\n|QT_MAT_DIURNO                |     19574|          0.99|      15.42|     78.93|       0|       0|       0|       0|     5657|▇▁▁▁▁ |\n|QT_MAT_NOTURNO               |     19574|          0.99|      23.66|     92.09|       0|       0|       0|       0|     6105|▇▁▁▁▁ |\n|QT_MAT_0_17                  |     19574|          0.99|       0.17|      1.06|       0|       0|       0|       0|      173|▇▁▁▁▁ |\n|QT_MAT_18_24                 |     19574|          0.99|      26.97|     92.11|       0|       0|       1|       9|     6068|▇▁▁▁▁ |\n|QT_MAT_25_29                 |     19574|          0.99|      10.69|     32.17|       0|       0|       1|       7|     2391|▇▁▁▁▁ |\n|QT_MAT_30_34                 |     19574|          0.99|       6.39|     20.17|       0|       0|       1|       5|     2815|▇▁▁▁▁ |\n|QT_MAT_35_39                 |     19574|          0.99|       4.23|     14.83|       0|       0|       1|       3|     3006|▇▁▁▁▁ |\n|QT_MAT_40_49                 |     19574|          0.99|       4.05|     16.96|       0|       0|       1|       3|     4803|▇▁▁▁▁ |\n|QT_MAT_50_59                 |     19574|          0.99|       1.14|      5.82|       0|       0|       0|       1|     2101|▇▁▁▁▁ |\n|QT_MAT_60_MAIS               |     19574|          0.99|       0.18|      1.08|       0|       0|       0|       0|      323|▇▁▁▁▁ |\n|QT_MAT_BRANCA                |     19574|          0.99|      18.09|     69.89|       0|       0|       1|       7|     6620|▇▁▁▁▁ |\n|QT_MAT_PRETA                 |     19574|          0.99|       2.73|     12.57|       0|       0|       0|       1|     1067|▇▁▁▁▁ |\n|QT_MAT_PARDA                 |     19574|          0.99|      11.20|     46.99|       0|       0|       1|       4|     4319|▇▁▁▁▁ |\n|QT_MAT_AMARELA               |     19574|          0.99|       0.72|      5.05|       0|       0|       0|       0|     1253|▇▁▁▁▁ |\n|QT_MAT_INDIGENA              |     19574|          0.99|       0.22|      3.28|       0|       0|       0|       0|     1309|▇▁▁▁▁ |\n|QT_MAT_CORND                 |     19574|          0.99|      20.85|     92.49|       0|       0|       1|       6|    16285|▇▁▁▁▁ |\n|QT_CONC                      |     19574|          0.99|       7.87|     29.54|       0|       0|       0|       3|     6441|▇▁▁▁▁ |\n|QT_CONC_FEM                  |     19574|          0.99|       4.79|     20.81|       0|       0|       0|       1|     5998|▇▁▁▁▁ |\n|QT_CONC_MASC                 |     19574|          0.99|       3.08|     12.03|       0|       0|       0|       1|     2932|▇▁▁▁▁ |\n|QT_CONC_DIURNO               |     19574|          0.99|       2.02|     12.21|       0|       0|       0|       0|     1375|▇▁▁▁▁ |\n|QT_CONC_NOTURNO              |     19574|          0.99|       3.72|     16.30|       0|       0|       0|       0|     1459|▇▁▁▁▁ |\n|QT_CONC_0_17                 |     19574|          0.99|       0.00|      0.01|       0|       0|       0|       0|        5|▇▁▁▁▁ |\n|QT_CONC_18_24                |     19574|          0.99|       2.85|     11.58|       0|       0|       0|       0|     1188|▇▁▁▁▁ |\n|QT_CONC_25_29                |     19574|          0.99|       2.10|      7.87|       0|       0|       0|       1|     1136|▇▁▁▁▁ |\n|QT_CONC_30_34                |     19574|          0.99|       1.13|      4.89|       0|       0|       0|       0|     1319|▇▁▁▁▁ |\n|QT_CONC_35_39                |     19574|          0.99|       0.76|      3.99|       0|       0|       0|       0|     1304|▇▁▁▁▁ |\n|QT_CONC_40_49                |     19574|          0.99|       0.77|      5.43|       0|       0|       0|       0|     2585|▇▁▁▁▁ |\n|QT_CONC_50_59                |     19574|          0.99|       0.23|      2.08|       0|       0|       0|       0|     1343|▇▁▁▁▁ |\n|QT_CONC_60_MAIS              |     19574|          0.99|       0.04|      0.36|       0|       0|       0|       0|      147|▇▁▁▁▁ |\n|QT_CONC_BRANCA               |     19574|          0.99|       2.70|     12.18|       0|       0|       0|       1|     1467|▇▁▁▁▁ |\n|QT_CONC_PRETA                |     19574|          0.99|       0.34|      2.05|       0|       0|       0|       0|      311|▇▁▁▁▁ |\n|QT_CONC_PARDA                |     19574|          0.99|       1.47|      7.81|       0|       0|       0|       0|      939|▇▁▁▁▁ |\n|QT_CONC_AMARELA              |     19574|          0.99|       0.11|      1.03|       0|       0|       0|       0|      294|▇▁▁▁▁ |\n|QT_CONC_INDIGENA             |     19574|          0.99|       0.03|      0.70|       0|       0|       0|       0|      356|▇▁▁▁▁ |\n|QT_CONC_CORND                |     19574|          0.99|       3.22|     20.42|       0|       0|       0|       0|     6404|▇▁▁▁▁ |\n|QT_ING_NACBRAS               |     19574|          0.99|      20.95|     59.20|       0|       1|       3|      17|    12071|▇▁▁▁▁ |\n|QT_ING_NACESTRANG            |     19574|          0.99|       0.04|      0.55|       0|       0|       0|       0|      406|▇▁▁▁▁ |\n|QT_MAT_NACBRAS               |     19574|          0.99|      53.70|    159.32|       0|       1|       4|      35|    16351|▇▁▁▁▁ |\n|QT_MAT_NACESTRANG            |     19574|          0.99|       0.11|      1.37|       0|       0|       0|       0|      526|▇▁▁▁▁ |\n|QT_CONC_NACBRAS              |     19574|          0.99|       7.86|     29.50|       0|       0|       0|       3|     6441|▇▁▁▁▁ |\n|QT_CONC_NACESTRANG           |     19574|          0.99|       0.02|      0.40|       0|       0|       0|       0|      262|▇▁▁▁▁ |\n|QT_ALUNO_DEFICIENTE          |     19574|          0.99|       0.34|      2.23|       0|       0|       0|       0|      672|▇▁▁▁▁ |\n|QT_ING_DEFICIENTE            |     19574|          0.99|       0.09|      0.76|       0|       0|       0|       0|      372|▇▁▁▁▁ |\n|QT_MAT_DEFICIENTE            |     19574|          0.99|       0.25|      1.85|       0|       0|       0|       0|      617|▇▁▁▁▁ |\n|QT_CONC_DEFICIENTE           |     19574|          0.99|       0.03|      0.34|       0|       0|       0|       0|       84|▇▁▁▁▁ |\n|QT_ING_FINANC                |     19574|          0.99|       6.50|     29.91|       0|       0|       0|       2|     3403|▇▁▁▁▁ |\n|QT_ING_FINANC_REEMB          |     19574|          0.99|       1.43|     11.05|       0|       0|       0|       0|     1675|▇▁▁▁▁ |\n|QT_ING_FIES                  |     19574|          0.99|       1.10|      9.94|       0|       0|       0|       0|     1675|▇▁▁▁▁ |\n|QT_ING_RPFIES                |     19574|          0.99|       0.25|      4.09|       0|       0|       0|       0|      654|▇▁▁▁▁ |\n|QT_ING_FINANC_REEMB_OUTROS   |     19574|          0.99|       0.09|      1.93|       0|       0|       0|       0|      638|▇▁▁▁▁ |\n|QT_ING_FINANC_NREEMB         |     19574|          0.99|       5.47|     27.29|       0|       0|       0|       2|     3398|▇▁▁▁▁ |\n|QT_ING_PROUNII               |     19574|          0.99|       0.76|      3.78|       0|       0|       0|       0|      623|▇▁▁▁▁ |\n|QT_ING_PROUNIP               |     19574|          0.99|       0.25|      2.77|       0|       0|       0|       0|      613|▇▁▁▁▁ |\n|QT_ING_NRPFIES               |     19574|          0.99|       4.15|     25.11|       0|       0|       0|       1|     3372|▇▁▁▁▁ |\n|QT_ING_FINANC_NREEMB_OUTROS  |     19574|          0.99|       0.43|      4.94|       0|       0|       0|       0|      899|▇▁▁▁▁ |\n|QT_MAT_FINANC                |     19574|          0.99|      16.14|     73.11|       0|       0|       0|       3|     8369|▇▁▁▁▁ |\n|QT_MAT_FINANC_REEMB          |     19574|          0.99|       5.41|     36.24|       0|       0|       0|       0|     3801|▇▁▁▁▁ |\n|QT_MAT_FIES                  |     19574|          0.99|       4.68|     33.92|       0|       0|       0|       0|     3797|▇▁▁▁▁ |\n|QT_MAT_RPFIES                |     19574|          0.99|       0.50|      7.97|       0|       0|       0|       0|     2806|▇▁▁▁▁ |\n|QT_MAT_FINANC_REEMB_OUTROS   |     19574|          0.99|       0.32|      5.68|       0|       0|       0|       0|     2775|▇▁▁▁▁ |\n|QT_MAT_FINANC_NREEMB         |     19574|          0.99|      11.90|     58.13|       0|       0|       0|       3|     8365|▇▁▁▁▁ |\n|QT_MAT_PROUNII               |     19574|          0.99|       2.51|     11.74|       0|       0|       0|       0|     1111|▇▁▁▁▁ |\n|QT_MAT_PROUNIP               |     19574|          0.99|       0.82|      8.26|       0|       0|       0|       0|     1401|▇▁▁▁▁ |\n|QT_MAT_NRPFIES               |     19574|          0.99|       7.76|     49.19|       0|       0|       0|       1|     7950|▇▁▁▁▁ |\n|QT_MAT_FINANC_NREEMB_OUTROS  |     19574|          0.99|       1.16|     12.77|       0|       0|       0|       0|     4098|▇▁▁▁▁ |\n|QT_CONC_FINANC               |     19574|          0.99|       2.16|     11.27|       0|       0|       0|       0|     1377|▇▁▁▁▁ |\n|QT_CONC_FINANC_REEMB         |     19574|          0.99|       0.72|      5.62|       0|       0|       0|       0|      700|▇▁▁▁▁ |\n|QT_CONC_FIES                 |     19574|          0.99|       0.64|      5.27|       0|       0|       0|       0|      693|▇▁▁▁▁ |\n|QT_CONC_RPFIES               |     19574|          0.99|       0.05|      1.35|       0|       0|       0|       0|      683|▇▁▁▁▁ |\n|QT_CONC_FINANC_REEMB_OUTROS  |     19574|          0.99|       0.05|      1.27|       0|       0|       0|       0|      469|▇▁▁▁▁ |\n|QT_CONC_FINANC_NREEMB        |     19574|          0.99|       1.59|      9.09|       0|       0|       0|       0|     1376|▇▁▁▁▁ |\n|QT_CONC_PROUNII              |     19574|          0.99|       0.38|      2.21|       0|       0|       0|       0|      375|▇▁▁▁▁ |\n|QT_CONC_PROUNIP              |     19574|          0.99|       0.13|      1.48|       0|       0|       0|       0|      231|▇▁▁▁▁ |\n|QT_CONC_NRPFIES              |     19574|          0.99|       0.97|      7.47|       0|       0|       0|       0|     1303|▇▁▁▁▁ |\n|QT_CONC_FINANC_NREEMB_OUTROS |     19574|          0.99|       0.17|      2.27|       0|       0|       0|       0|      684|▇▁▁▁▁ |\n|QT_ING_RESERVA_VAGA          |     19574|          0.99|       0.82|      6.12|       0|       0|       0|       0|      770|▇▁▁▁▁ |\n|QT_ING_RVREDEPUBLICA         |     19574|          0.99|       0.68|      5.42|       0|       0|       0|       0|      666|▇▁▁▁▁ |\n|QT_ING_RVETNICO              |     19574|          0.99|       0.36|      3.02|       0|       0|       0|       0|      330|▇▁▁▁▁ |\n|QT_ING_RVPDEF                |     19574|          0.99|       0.01|      0.18|       0|       0|       0|       0|       34|▇▁▁▁▁ |\n|QT_ING_RVSOCIAL_RF           |     19574|          0.99|       0.26|      2.44|       0|       0|       0|       0|      308|▇▁▁▁▁ |\n|QT_ING_RVOUTROS              |     19574|          0.99|       0.03|      1.58|       0|       0|       0|       0|      770|▇▁▁▁▁ |\n|QT_MAT_RESERVA_VAGA          |     19574|          0.99|       2.45|     19.00|       0|       0|       0|       0|     3140|▇▁▁▁▁ |\n|QT_MAT_RVREDEPUBLICA         |     19574|          0.99|       1.98|     16.88|       0|       0|       0|       0|     3021|▇▁▁▁▁ |\n|QT_MAT_RVETNICO              |     19574|          0.99|       1.06|      9.45|       0|       0|       0|       0|     1069|▇▁▁▁▁ |\n|QT_MAT_RVPDEF                |     19574|          0.99|       0.02|      0.46|       0|       0|       0|       0|      123|▇▁▁▁▁ |\n|QT_MAT_RVSOCIAL_RF           |     19574|          0.99|       0.74|      7.64|       0|       0|       0|       0|     1531|▇▁▁▁▁ |\n|QT_MAT_RVOUTROS              |     19574|          0.99|       0.09|      2.80|       0|       0|       0|       0|      948|▇▁▁▁▁ |\n|QT_CONC_RESERVA_VAGA         |     19574|          0.99|       0.19|      2.13|       0|       0|       0|       0|      441|▇▁▁▁▁ |\n|QT_CONC_RVREDEPUBLICA        |     19574|          0.99|       0.15|      1.76|       0|       0|       0|       0|      302|▇▁▁▁▁ |\n|QT_CONC_RVETNICO             |     19574|          0.99|       0.07|      1.00|       0|       0|       0|       0|      249|▇▁▁▁▁ |\n|QT_CONC_RVPDEF               |     19574|          0.99|       0.00|      0.06|       0|       0|       0|       0|       36|▇▁▁▁▁ |\n|QT_CONC_RVSOCIAL_RF          |     19574|          0.99|       0.05|      0.74|       0|       0|       0|       0|      124|▇▁▁▁▁ |\n|QT_CONC_RVOUTROS             |     19574|          0.99|       0.01|      0.62|       0|       0|       0|       0|      323|▇▁▁▁▁ |\n|QT_SIT_TRANCADA              |     19574|          0.99|       8.04|     36.34|       0|       0|       0|       3|     3675|▇▁▁▁▁ |\n|QT_SIT_DESVINCULADO          |     19574|          0.99|      11.90|     40.38|       0|       0|       1|       8|    12110|▇▁▁▁▁ |\n|QT_SIT_TRANSFERIDO           |     19574|          0.99|       0.66|      8.49|       0|       0|       0|       0|     4005|▇▁▁▁▁ |\n|QT_SIT_FALECIDO              |     19574|          0.99|       0.01|      0.13|       0|       0|       0|       0|       29|▇▁▁▁▁ |\n|QT_ING_PROCESCPUBLICA        |     19574|          0.99|      12.79|     38.92|       0|       0|       2|       8|     3486|▇▁▁▁▁ |\n|QT_ING_PROCESCPRIVADA        |     19574|          0.99|       4.72|     23.08|       0|       0|       0|       1|     4304|▇▁▁▁▁ |\n|QT_ING_PROCNAOINFORMADA      |     19574|          0.99|       2.35|     24.71|       0|       0|       0|       0|    12082|▇▁▁▁▁ |\n|QT_MAT_PROCESCPUBLICA        |     19574|          0.99|      28.81|     88.93|       0|       0|       2|      16|     6833|▇▁▁▁▁ |\n|QT_MAT_PROCESCPRIVADA        |     19574|          0.99|      13.04|     67.51|       0|       0|       0|       2|     7457|▇▁▁▁▁ |\n|QT_MAT_PROCNAOINFORMADA      |     19574|          0.99|       8.75|     68.23|       0|       0|       0|       0|    16351|▇▁▁▁▁ |\n|QT_CONC_PROCESCPUBLICA       |     19574|          0.99|       3.98|     15.58|       0|       0|       0|       1|     2807|▇▁▁▁▁ |\n|QT_CONC_PROCESCPRIVADA       |     19574|          0.99|       1.78|     10.89|       0|       0|       0|       0|     1351|▇▁▁▁▁ |\n|QT_CONC_PROCNAOINFORMADA     |     19574|          0.99|       1.59|     17.03|       0|       0|       0|       0|     6435|▇▁▁▁▁ |\n|QT_PARFOR                    |     19574|          0.99|       0.36|     13.31|       0|       0|       0|       0|     5059|▇▁▁▁▁ |\n|QT_ING_PARFOR                |     19574|          0.99|       0.07|      3.45|       0|       0|       0|       0|     1139|▇▁▁▁▁ |\n|QT_MAT_PARFOR                |     19574|          0.99|       0.28|     10.60|       0|       0|       0|       0|     4416|▇▁▁▁▁ |\n|QT_CONC_PARFOR               |     19574|          0.99|       0.05|      4.25|       0|       0|       0|       0|     3868|▇▁▁▁▁ |\n|QT_APOIO_SOCIAL              |     19574|          0.99|       6.78|     45.17|       0|       0|       0|       0|     6212|▇▁▁▁▁ |\n|QT_ING_APOIO_SOCIAL          |     19574|          0.99|       1.95|     13.38|       0|       0|       0|       0|     1879|▇▁▁▁▁ |\n|QT_MAT_APOIO_SOCIAL          |     19574|          0.99|       5.38|     35.38|       0|       0|       0|       0|     3514|▇▁▁▁▁ |\n|QT_CONC_APOIO_SOCIAL         |     19574|          0.99|       0.74|      5.59|       0|       0|       0|       0|      571|▇▁▁▁▁ |\n|QT_ATIV_EXTRACURRICULAR      |     19574|          0.99|       9.33|     66.72|       0|       0|       0|       0|     8457|▇▁▁▁▁ |\n|QT_ING_ATIV_EXTRACURRICULAR  |     19574|          0.99|       2.09|     18.43|       0|       0|       0|       0|     3907|▇▁▁▁▁ |\n|QT_MAT_ATIV_EXTRACURRICULAR  |     19574|          0.99|       8.10|     56.11|       0|       0|       0|       0|     6970|▇▁▁▁▁ |\n|QT_CONC_ATIV_EXTRACURRICULAR |     19574|          0.99|       1.39|     10.60|       0|       0|       0|       0|     1627|▇▁▁▁▁ |\n|QT_MOB_ACADEMICA             |     19574|          0.99|       0.07|      1.88|       0|       0|       0|       0|      581|▇▁▁▁▁ |\n|QT_ING_MOB_ACADEMICA         |     19574|          0.99|       0.00|      0.26|       0|       0|       0|       0|      130|▇▁▁▁▁ |\n|QT_MAT_MOB_ACADEMICA         |     19574|          0.99|       0.06|      1.68|       0|       0|       0|       0|      523|▇▁▁▁▁ |\n|QT_CONC_MOB_ACADEMICA        |     19574|          0.99|       0.00|      0.22|       0|       0|       0|       0|      107|▇▁▁▁▁ |\n:::\n:::\n\n\n### Create new data frames - profile students\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents <- listed_df %>%\n  unnest(cols = '.') %>% # unlist and merge data.frames\n  janitor::clean_names() %>%\n  select(co_ies, nu_ano_censo, no_regiao, no_uf, starts_with('qt_in')) %>%\n  right_join(regions_states, by = c('co_ies', 'no_regiao', 'no_uf')) %>%\n  group_by(nu_ano_censo, no_regiao, no_uf) %>%\n  summarise_all(sum, na.rm = T) %>%\n  ungroup()\n```\n:::\n\n\n# Data analysis\n\n## Time Series\n\n### Students by sex - Brazil\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(students) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 68\n  nu_ano_censo no_regiao   no_uf co_ies qt_inscrito_total qt_inscrito_total_di…¹\n         <int> <chr>       <chr>  <int>             <int>                  <int>\n1         2009 Centro-Oes… Dist… 6.32e5            182408                      0\n2         2009 Centro-Oes… Goiás 1.23e6            169410                      0\n3         2009 Centro-Oes… Mato… 5.64e5             90688                      0\n4         2009 Centro-Oes… Mato… 7.35e5             59392                      0\n5         2009 Nordeste    Alag… 6.96e5             67306                      0\n6         2009 Nordeste    Bahia 2.27e6            292286                      0\n# ℹ abbreviated name: ¹​qt_inscrito_total_diurno\n# ℹ 62 more variables: qt_inscrito_total_noturno <int>,\n#   qt_inscrito_total_ead <int>, qt_insc_vg_nova <int>,\n#   qt_insc_proc_seletivo <int>, qt_insc_vg_remanesc <int>,\n#   qt_insc_vg_prog_especial <int>, qt_ing <int>, qt_ing_fem <int>,\n#   qt_ing_masc <int>, qt_ing_diurno <int>, qt_ing_noturno <int>,\n#   qt_ing_vg_nova <int>, qt_ing_vestibular <int>, qt_ing_enem <int>, …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data) %>%\n  summarise_at(c('qt_ing_fem', 'qt_ing_masc'), sum) %>%\n  gather('var', 'value', 2:3) %>%\n  ggplot(aes(x = data, \n             y = value,\n             linetype = factor(var, \n                        labels = c('Female', 'Male')),\n             fill = factor(var, \n                        labels = c('Female', 'Male')))) +\n  geom_bar(stat = 'identity', position = 'dodge') +\n  geom_smooth(method = 'loess', col = 'black') +\n  ggthemes::scale_fill_ptol() +\n  ggthemes::theme_clean() +\n  guides(fill = guide_legend('Sex'),\n         linetype = guide_legend('Sex')) +\n  xlab('') +\n  scale_y_continuous(name = 'Number of students admitted', \n                     labels = scales::label_number(suffix = \"K\", scale = 1e-3, big.mark = '.'),\n                     breaks = seq(0,1500000, by = 250000)) +\n  ggtitle('Number of Students by sex')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-18-1.png){width=50%}\n:::\n:::\n\n\n### Students by time - Regions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data, no_regiao) %>%\n  summarise_at(c('qt_ing_fem', 'qt_ing_masc'), sum) %>%\n  gather('var', 'value', 3:4) %>%\n  ggplot(aes(x = data, \n             y = value,\n             linetype = factor(var, \n                        labels = c('Female', 'Male')),\n             fill = factor(var, \n                        labels = c('Female', 'Male')))) +\n  geom_bar(stat = 'identity', position = 'dodge') +\n  geom_smooth(method = 'loess', col = 'black') +\n  facet_wrap(~ no_regiao, scales = 'free_y') +\n  ggthemes::scale_fill_ptol() +\n  ggthemes::theme_clean() +\n  guides(fill = guide_legend('Sex'),\n         linetype = guide_legend('Sex')) +\n  xlab('') +\n  scale_y_continuous(name = 'Number of students admitted', \n                     labels = scales::label_number(suffix = \" K\", scale = 1e-3)) +\n  ggtitle('Number of Students by sex and Region')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=50%}\n:::\n:::\n\n\n### Students by time - States\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data, no_uf) %>%\n  summarise_at(c('qt_ing_fem', 'qt_ing_masc'), sum) %>%\n  gather('var', 'value', 3:4) %>%\n  ggplot(aes(x = data, \n             y = value,\n             linetype = factor(var, \n                        labels = c('Female', 'Male')),\n             fill = factor(var, \n                        labels = c('Female', 'Male')))) +\n  geom_bar(stat = 'identity', position = 'dodge') +\n  geom_smooth(method = 'loess', col = 'black') +\n  facet_wrap(~ no_uf, scales = 'free_y') +\n  ggthemes::scale_fill_ptol() +\n  ggthemes::theme_clean() +\n  guides(fill = guide_legend('Sex'),\n         linetype = guide_legend('Sex')) +\n  xlab('') +\n  scale_y_continuous(name = 'Number of students admitted', \n                     labels = scales::label_number(suffix = \" K\", scale = 1e-3)) +\n  ggtitle('Number of Students by sex and States')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-22-1.png){width=50%}\n:::\n:::\n\n\n### Students by ethnic group - Brazil\n\nWe use the IBGE's ethnicity classification. Link: <https://educa.ibge.gov.br/jovens/conheca-o-brasil/populacao/18319-cor-ou-raca.html>\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data) %>%\n  summarise_at(c('qt_ing_branca', 'qt_ing_preta', 'qt_ing_indigena',\n                 'qt_ing_parda', 'qt_ing_amarela', 'qt_ing_cornd'), sum) %>%\n  gather('var', 'value', 2:7) %>%\n  mutate(var = case_when(var == 'qt_ing_branca' ~ 'White',\n                         var == 'qt_ing_preta' ~ 'Black',\n                         var == 'qt_ing_indigena' ~ 'Indigenous',\n                         var == 'qt_ing_parda' ~ 'Brown', \n                         var == 'qt_ing_amarela' ~ 'Asian', \n                         var == 'qt_ing_cornd' ~ 'Not\\nDefined')) %>%\n  ggplot(aes(x = data, \n             y = value,\n             linetype = var,\n             fill = var)) +\n  geom_bar(stat = 'identity', position = 'dodge') +\n  geom_smooth(method = 'loess', col = 'black') +\n  ggthemes::scale_fill_ptol() +\n  ggthemes::theme_clean() +\n  facet_wrap( ~ var, scales = 'free_y') +\n  guides(fill = F,\n         linetype = F) +\n  xlab('') +\n  scale_y_continuous(name = 'Number of students admitted', \n                     labels = scales::label_number(suffix = \"K\", scale = 1e-3, big.mark = '.')) +\n  ggtitle('Number of Students by ethnic group')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=50%}\n:::\n:::\n\n\n### Students by ethnic group - Regions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data, no_regiao) %>%\n  summarise_at(c('qt_ing_branca', 'qt_ing_preta', 'qt_ing_indigena',\n                 'qt_ing_parda', 'qt_ing_amarela', 'qt_ing_cornd'), sum) %>%\n  gather('var', 'value', 3:8) %>%\n  mutate(var = case_when(var == 'qt_ing_branca' ~ 'White',\n                         var == 'qt_ing_preta' ~ 'Black',\n                         var == 'qt_ing_indigena' ~ 'Indigenous',\n                         var == 'qt_ing_parda' ~ 'Brown', \n                         var == 'qt_ing_amarela' ~ 'Asian', \n                         var == 'qt_ing_cornd' ~ 'Not\\nDefined')) %>%\n  ggplot(aes(x = data, \n             y = value,\n             linetype = var,\n             fill = var)) +\n  geom_bar(stat = 'identity', position = 'dodge') +\n  geom_smooth(method = 'loess', col = 'black') +\n  ggthemes::scale_fill_ptol() +\n  ggthemes::theme_clean() +\n  facet_grid(var ~ no_regiao, scales = 'free_y') +\n  guides(fill = F,\n         linetype = F) +\n  xlab('') +\n  scale_y_continuous(name = 'Number of students admitted', \n                     labels = scales::label_number(suffix = \"K\", scale = 1e-3, big.mark = '.')) +\n  ggtitle('Number of Students by ethnic group and Region')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=50%}\n:::\n:::\n\n\n### Students by age - Brazil\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data) %>%\n  summarise_at(c(\"qt_ing_0_17\", \"qt_ing_18_24\", \"qt_ing_25_29\", \"qt_ing_30_34\",\n                 \"qt_ing_35_39\", \"qt_ing_40_49\", \"qt_ing_50_59\", \"qt_ing_60_mais\"), sum) %>%\n  gather('var', 'value', 2:9) %>%\n  mutate(var = case_when(var == 'qt_ing_0_17' ~ '<18',\n                         var == 'qt_ing_18_24' ~ '18~24',\n                         var == 'qt_ing_25_29' ~ '25~29',\n                         var == 'qt_ing_30_34' ~ '30~34', \n                         var == 'qt_ing_35_39' ~ '35~39', \n                         var == 'qt_ing_40_49' ~ '40~49',\n                         var == 'qt_ing_50_59' ~ '50~59',\n                         var == 'qt_ing_60_mais' ~ '>60'),\n         var = fct_relevel(as.factor(var), '<18', '18~24', '25~29',\n                           '30~34', '35~39', '40~49', \n                           '50~59', '>60')) %>%\n  ggplot(aes(x = data, \n             y = value,\n             linetype = var,\n             fill = var)) +\n  geom_bar(stat = 'identity', position = 'dodge') +\n  geom_smooth(method = 'loess', col = 'black') +\n  ggthemes::scale_fill_ptol() +\n  ggthemes::theme_clean() +\n  facet_wrap( ~ var, scales = 'free_y') +\n  guides(fill = F,\n         linetype = F) +\n  xlab('') +\n  scale_y_continuous(name = 'Number of students admitted', \n                     labels = scales::label_number(suffix = \"K\", scale = 1e-3, big.mark = '.')) +\n  ggtitle('Number of Students by age')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=50%}\n:::\n:::\n\n\n### Students by ethnic group - Regions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudents %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data, no_regiao) %>%\n  summarise_at(c(\"qt_ing_0_17\", \"qt_ing_18_24\", \"qt_ing_25_29\", \"qt_ing_30_34\",\n                 \"qt_ing_35_39\", \"qt_ing_40_49\", \"qt_ing_50_59\", \"qt_ing_60_mais\"), sum) %>%\n  gather('var', 'value', 3:10) %>%\n  mutate(var = case_when(var == 'qt_ing_0_17' ~ '<18',\n                         var == 'qt_ing_18_24' ~ '18~24',\n                         var == 'qt_ing_25_29' ~ '25~29',\n                         var == 'qt_ing_30_34' ~ '30~34', \n                         var == 'qt_ing_35_39' ~ '35~39', \n                         var == 'qt_ing_40_49' ~ '40~49',\n                         var == 'qt_ing_50_59' ~ '50~59',\n                         var == 'qt_ing_60_mais' ~ '>60'),\n         var = fct_relevel(as.factor(var), '<18', '18~24', '25~29',\n                           '30~34', '35~39', '40~49', \n                           '50~59', '>60')) %>%\n  ggplot(aes(x = data, \n             y = value,\n             linetype = var,\n             fill = var)) +\n  geom_bar(stat = 'identity', position = 'dodge') +\n  geom_smooth(method = 'loess', col = 'black') +\n  ggthemes::scale_fill_ptol() +\n  ggthemes::theme_clean() +\n  facet_grid(var ~ no_regiao, scales = 'free_y') +\n  guides(fill = F,\n         linetype = F) +\n  xlab('') +\n  scale_y_continuous(name = 'Number of students admitted', \n                     labels = scales::label_number(suffix = \"K\", scale = 1e-3, big.mark = '.')) +\n  ggtitle('Number of Students by age')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-30-1.png){width=50%}\n:::\n:::\n\n\n## Statistical Analysis\n\n### What explain the growth of students admmited around the years?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstats_df <- students %>%\n  mutate(data = zoo::as.yearmon(nu_ano_censo)) %>%\n  group_by(data, no_regiao, no_uf) %>%\n  summarise_if(is.numeric, sum) %>%\n  ungroup() %>%\n  select(data, no_regiao, no_uf, qt_ing_fem:qt_ing_noturno, qt_ing_0_17:qt_ing_cornd, qt_ing_financ:qt_ing_apoio_social) %>%\n  gather('var', 'value', 4:42) %>%\n  group_by(data, no_regiao, no_uf, var) %>%\n  summarise_if(is.numeric, sum) %>%\n  ungroup()\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstats_df %>%\n  mutate(value = ifelse(value == 0, 1, value)) %>%\n  lm(log(value) ~ as.factor(var) + data + as.factor(no_regiao) + as.factor(no_uf), data = .) %>%\n  sjPlot::tab_model(show.ci = F, show.est = T, show.se = T, show.r2 = T, show.stat = T,\n                    pred.labels = labels_table_model,\n                    dv.labels = 'Relationship between number of students admitted')\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table style=\"border-collapse:collapse; border:none;\">\n<tr>\n<th style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; \">&nbsp;</th>\n<th colspan=\"4\" style=\"border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; \">Relationship between number of students admitted</th>\n</tr>\n<tr>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; \">Predictors</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Estimates</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">std. Error</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">Statistic</td>\n<td style=\" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  \">p</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Intercept</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;203.99</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">7.33</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;27.82</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age (18~24)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.74</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">31.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age (25~29)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.38</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">19.83</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age (30~34)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.91</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">15.89</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age (35~39)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">11.85</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age (40~49)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">10.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age (50~59)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.91</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.364</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Age (>60)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.04</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;16.98</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Ethnic (Asian)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.26</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.20</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.028</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Any Social Support</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Ethnic (White)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.71</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">22.57</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Ethnic (Not declared)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">25.77</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Shift (Diurnal)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.52</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">20.97</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Sex (Female)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.67</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">30.50</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support (FIES)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.11</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.24</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.86</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">23.79</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support<br>(Non-refundable)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.52</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">20.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support<br>(Non-refundable others)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.90</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;7.46</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support<br>(Refundable)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.51</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">12.55</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support<br>(Refundable others)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.86</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;15.46</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Ethnic (Indigenous)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.43</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;11.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Sex (Male)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">28.60</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Shift (Nocturnal)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.84</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">23.63</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support<br>(Non-refundable FIES)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.88</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">15.68</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Ethnic (Brown)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.77</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">23.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Social Support (PARFOR)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;4.33</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;36.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Ethnic (Black)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.13</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.42</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Type high school<br>(Private)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.14</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">17.78</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Type high school (Public)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.85</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">23.67</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Type high school (Not<br>declared)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.01</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;24.99</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support (PROUNI<br>whole)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.77</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.37</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support (PROUNI<br>parcial)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.48</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;4.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Social Support (Quotas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Income Support<br>(Refundable FIES)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;14.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Social Support (Ethnic<br>quotas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.28</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.30</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.021</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Social Support (Other<br>quotas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.45</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;28.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Social Support<br>(Disabilities quotas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;3.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;32.66</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Social Support (Public<br>high school quotas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.67</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.54</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Social Support (Family<br>income quotas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.12</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;8.61</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Date</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">28.68</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Region (Nordeste)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.47</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;4.74</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Region (Norte)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.85</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;18.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Region (Sudeste)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.67</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">26.72</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">Region (Sul)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.85</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">8.51</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Alagoas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.08</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.80</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.423</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Amapá)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.53</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.011</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Amazonas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.86</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">18.56</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Bahia)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.62</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">16.23</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Ceará)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.97</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Distrito Federal)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.36</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">3.60</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Espirito Santo)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;2.61</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;26.06</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Goiás)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.59</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.89</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Maranhão)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.59</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">5.91</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Mato Grosso)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.33</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.744</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Minas Gerais)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.95</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;9.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Pará)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">19.25</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Paraíba)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.69</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.95</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Paraná)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.66</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">6.58</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Alagoas)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">1.09</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">10.89</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Pernambuco)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.00</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.03</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.978</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Rio de Janeiro)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.93</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;9.32</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Rio Grande do<br>Norte)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.29</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">2.90</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>0.004</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Rio Grande do Sul)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.44</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">4.39</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Rondônia)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.98</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">9.78</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Roraima)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;0.15</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">&#45;1.49</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.136</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; \">State (Tocantins)</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.85</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">0.10</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \">8.47</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  \"><strong>&lt;0.001</strong></td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;\">Observations</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;\" colspan=\"4\">13689</td>\n</tr>\n<tr>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;\">R<sup>2</sup> / R<sup>2</sup> adjusted</td>\n<td style=\" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;\" colspan=\"4\">0.704 / 0.703</td>\n</tr>\n\n</table>\n\n`````\n:::\n:::\n\n\n## Cluster Analysis\n\n### Region and Sex\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_regiao_sex <- stats_df %>%\n  pivot_wider(names_from = var, values_from = value) %>%\n  group_by(no_regiao) %>%\n  summarise_if(is.numeric, sum) %>%\n  select(no_regiao, Male = qt_ing_masc, Female = qt_ing_fem)\n\nnames_cluster_regiao_sex <- cluster_regiao_sex$no_regiao\n\ncluster_regiao_sex <- scale(cluster_regiao_sex[,2:3])\n\nrownames(cluster_regiao_sex) <- names_cluster_regiao_sex\n```\n:::\n\n\n> Determine numbers of clusters  with 1000 boostraping Monte-Carlo's method. **The highest GAP value determines the number of clusters\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclusGap(cluster_regiao_sex, FUN = kmeans, K.max = 4, B = 1000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = cluster_regiao_sex, FUNcluster = kmeans, K.max = 4, B = 1000)\nB=1000 simulated reference sets, k = 1..4; spaceH0=\"scaledPCA\"\n --> Number of clusters (method 'firstSEmax', SE.factor=1): 3\n           logW     E.logW        gap    SE.sim\n[1,]  0.4505538  0.1137544 -0.3367994 0.3310093\n[2,] -0.7881861 -1.0546936 -0.2665074 0.4799946\n[3,] -2.7123135 -2.0631702  0.6491432 0.7010267\n[4,] -2.9323467 -3.3275129 -0.3951662 1.1037812\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cluster(kmeans(cluster_regiao_sex, 4, nstart = 25), cluster_regiao_sex[,1:2], ellipse.type = \"norm\", \n             repel = T, ggtheme = ggthemes::theme_clean(), palette = c('#4477AA', '#CC6677', '#117733', '#AA4499'),\n             main = 'Grouping by Regions and Sex')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-42-1.png){width=50%}\n:::\n:::\n\n\n### States and Sex\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_uf_sex <- stats_df %>%\n  pivot_wider(names_from = var, values_from = value) %>%\n  group_by(no_uf) %>%\n  summarise_if(is.numeric, sum) %>%\n  select(no_uf, Male = qt_ing_masc, Female = qt_ing_fem) %>%\n  ungroup()\n\nnames_cluster_uf_sex <- cluster_uf_sex$no_uf\n\ncluster_uf_sex <- scale(cluster_uf_sex[,2:3])\n\nrownames(cluster_uf_sex) <- names_cluster_uf_sex\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclusGap(cluster_uf_sex, FUN = kmeans, K.max = 10, B = 1000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = cluster_uf_sex, FUNcluster = kmeans, K.max = 10, B = 1000)\nB=1000 simulated reference sets, k = 1..10; spaceH0=\"scaledPCA\"\n --> Number of clusters (method 'firstSEmax', SE.factor=1): 1\n            logW     E.logW       gap     SE.sim\n [1,]  1.9210186 2.75971814 0.8386996 0.09247111\n [2,]  1.3167563 1.99796439 0.6812081 0.10096206\n [3,]  0.6074882 1.53602390 0.9285357 0.11274751\n [4,]  0.1783817 1.20183328 1.0234516 0.13222136\n [5,] -0.1905742 0.94694388 1.1375181 0.14651081\n [6,] -0.5996838 0.72462173 1.3243055 0.16729396\n [7,] -0.8412209 0.52123761 1.3624585 0.17156492\n [8,] -0.9273895 0.34413963 1.2715291 0.17780381\n [9,] -0.9230093 0.18025695 1.1032662 0.19565201\n[10,] -0.9445048 0.01706843 0.9615732 0.21111475\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cluster(kmeans(cluster_uf_sex, 7, nstart = 25), cluster_uf_sex, ellipse.type = \"norm\", \n             repel = T, ggtheme = ggthemes::theme_clean(), palette = c('#4477AA', '#CC6677', '#117733', '#DDCC77', '#AA4499', '#661100', '#44AA99'),\n             main = 'Grouping by States and Sex')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-48-1.png){width=50%}\n:::\n:::\n\n\n### Region and Ethnic group\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_regiao_ethnic <- stats_df %>%\n  pivot_wider(names_from = var, values_from = value) %>%\n  group_by(no_regiao) %>%\n  summarise_if(is.numeric, sum) %>%\n  select(no_regiao, \n         White = qt_ing_branca, \n         Black = qt_ing_preta,\n         Brown = qt_ing_parda,\n         Asian = qt_ing_amarela,\n         Not_declared = qt_ing_cornd) %>%\n  ungroup()\n\nnames_cluster_regiao_ethnic <- cluster_regiao_ethnic$no_regiao\n\ncluster_regiao_ethnic <- scale(cluster_regiao_ethnic[,2:6])\n\nrownames(cluster_regiao_ethnic) <- names_cluster_regiao_ethnic\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclusGap(cluster_regiao_ethnic, FUN = kmeans, K.max = 4, B = 1000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = cluster_regiao_ethnic, FUNcluster = kmeans, K.max = 4, B = 1000)\nB=1000 simulated reference sets, k = 1..4; spaceH0=\"scaledPCA\"\n --> Number of clusters (method 'firstSEmax', SE.factor=1): 1\n            logW     E.logW         gap    SE.sim\n[1,]  0.98914154  0.6436219 -0.34551964 0.2694575\n[2,]  0.05708892 -0.2793237 -0.33641267 0.3099016\n[3,] -0.69001914 -1.0091417 -0.31912255 0.4129403\n[4,] -2.10760301 -2.0092579  0.09834512 0.6181882\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cluster(kmeans(cluster_regiao_ethnic, 4, nstart = 25), cluster_regiao_ethnic, ellipse.type = \"norm\", \n             repel = T, ggtheme = ggthemes::theme_clean(), palette = c('#4477AA', '#CC6677', '#117733', '#AA4499'),\n             main = 'Grouping by Regions and Ethnic group')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-54-1.png){width=50%}\n:::\n:::\n\n\n### States and ethnic group\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster_uf_ethnic <- stats_df %>%\n  pivot_wider(names_from = var, values_from = value) %>%\n  group_by(no_uf) %>%\n  summarise_if(is.numeric, sum) %>%\n  select(no_uf, \n         White = qt_ing_branca, \n         Black = qt_ing_preta,\n         Brown = qt_ing_parda,\n         Asian = qt_ing_amarela,\n         Not_declared = qt_ing_cornd) %>%\n  ungroup()\n\nnames_cluster_uf_ethnic <- cluster_uf_ethnic$no_uf\n\ncluster_uf_ethnic <- scale(cluster_uf_ethnic[,2:6])\n\nrownames(cluster_uf_ethnic) <- names_cluster_uf_ethnic\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nclusGap(cluster_uf_ethnic, FUN = kmeans, K.max = 10, B = 1000)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nClustering Gap statistic [\"clusGap\"] from call:\nclusGap(x = cluster_uf_ethnic, FUNcluster = kmeans, K.max = 10, B = 1000)\nB=1000 simulated reference sets, k = 1..10; spaceH0=\"scaledPCA\"\n --> Number of clusters (method 'firstSEmax', SE.factor=1): 1\n           logW   E.logW       gap     SE.sim\n [1,] 2.4999073 3.232583 0.7326755 0.08626548\n [2,] 2.0205604 2.585291 0.5647302 0.07815342\n [3,] 1.5889466 2.246243 0.6572962 0.07431026\n [4,] 1.3249374 2.035338 0.7104011 0.07746661\n [5,] 1.0961798 1.881557 0.7853776 0.07756807\n [6,] 0.9763831 1.758331 0.7819478 0.08229915\n [7,] 0.7005265 1.642111 0.9415846 0.08014051\n [8,] 0.4957878 1.534616 1.0388281 0.08417066\n [9,] 0.3391365 1.431623 1.0924869 0.08288289\n[10,] 0.5364155 1.332864 0.7964489 0.08542264\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfviz_cluster(kmeans(cluster_uf_ethnic, 9, nstart = 25), cluster_uf_ethnic, ellipse.type = \"norm\", \n             repel = T, ggtheme = ggthemes::theme_clean(), palette = c('#4477AA', '#CC6677', '#117733', '#DDCC77', '#AA4499', '#661100', '#44AA99', '#332288', '#AA4466'),\n             main = 'Grouping by States and Ethnic group')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-60-1.png){width=50%}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}